import pandas as pd

from classes import Polucio, Meteo
from funcions import omplir_buits, crear_dies_previs, split_train_test
from config import pol_arxiu, data_inici, area_geo, nom_area, contaminant, meteo_arxiu, var_arxiu, est_arxiu


if __name__ == '__main__':
    polucio = Polucio(pol_arxiu=pol_arxiu, data_inici=data_inici, area_geo=area_geo, nom_area=nom_area, contaminant=contaminant)
    polucio_df = polucio.transformar_pol_arxiu()
    meteo = Meteo(meteo_arxiu=meteo_arxiu, var_arxiu=var_arxiu, est_arxiu=est_arxiu)
    meteo_df = meteo.transformar_meteo_arxiu()
    df= polucio_df.merge(meteo_df, left_on=['data', 'nom_estacio'], right_on=['data_lectura', 'nom_estacio'])
    print(df.head())